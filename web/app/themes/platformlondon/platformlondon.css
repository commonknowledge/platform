/*
Theme Name: Platform London
Theme URI: 
Author: Common Knowledge
Author URI: 
Description: 
Requires at least: 5.8
Tested up to: 6.2
Requires PHP: 5.7
Version: 0.0.1
License: GNU General Public License v2 or later
License URI: http://www.gnu.org/licenses/gpl-2.0.html
Text Domain: platformlondon
Tags: full-site-editing, 
*/

@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * Global WordPress Overrides
 */

.wp-block-image.size-full {
    @apply !m-0 !max-w-none;
}

.wp-block-image.size-full>img {
    @apply !w-full;
}

.wp-block-image.size-large>img {
    @apply md:-ml-16 md:-mr-16 md:max-w-[calc(100%+8rem)];
}

.wp-block-separator {
    @apply border-dark-green !border-t-0 border-b;
}

/*
 * HTML Elements
 */
h1,
h2,
h3,
h4,
h5,
h6 {
    @apply uppercase;
}

/*
 * Components
 */

.btn-default-no-padding {
    @apply hover:!bg-dark-green hover:!text-white border border-dark-green rounded-full shadow-md truncate;
}

.btn-default {
    @apply btn-default-no-padding !py-2 !px-4;
}

.btn-active {
    @apply bg-dark-green !text-white;
}

.wp-block-search {
    @apply relative;
}
.wp-block-search__input {
    @apply border border-dark-green rounded-full shadow-md truncate relative z-40 !px-4;
    background: none !important;
}
.wp-block-search::after {
    content: "";
    background-image: url("/app/themes/platformlondon/assets/img/search.svg");
    height: 1rem;
    position: absolute;
    right: 1rem;
    top: 0.75rem;
    width: 1rem;
}

/*
 * Template Custom Styles
 */


/* Header */


/* Nav */
.wp-block-navigation-item__content {
    @apply btn-default relative z-40;
}

.current-menu-item .wp-block-navigation-item__content {
    @apply btn-active;
}

header .wp-block-search {
    @apply !mb-0;
}

/* Page */
.page h1.wp-block-post-title {
    @apply text-6xl md:text-8xl mb-16;
}

/* Prevent double padding from query block and child items */
.page .has-global-padding .wp-block-query {
    @apply !-ml-4 !-mr-4;
}

.page .wp-block-query-no-results {
    @apply px-4;
}

.page .wp-block-query-pagination {
    @apply p-4 mt-8;
}

.page .wp-block-query-pagination-numbers {
    @apply !m-auto;
}

.page .wp-block-query-pagination .page-numbers {
    @apply btn-default-no-padding !rounded-full !px-[0.9rem] !py-2;
}

.page .wp-block-query-pagination .page-numbers.current {
    @apply !bg-dark-green !text-white;
}

.page .wp-block-query-pagination .wp-block-query-pagination-previous {
    @apply hidden;
}

.page .wp-block-query-pagination .wp-block-query-pagination-next {
    @apply hidden;
}

.wp-block-post-content {
    @apply mb-16;
}

.wp-block-post-content p {
    @apply mb-4;
}

.wp-block-post-content ul {
    @apply list-disc pl-4;
}

.wp-block-post-content ul.is-flex-container {
    @apply !pl-0;
}

.wp-block-post-content li {
    @apply mb-4;
}

.page .wp-site-blocks > hr {
    @apply mx-4 mb-12;
}

/* Cover */
.wp-block-cover .wp-block-navigation-item a {
    @apply !bg-cream !text-dark-green hover:!bg-dark-green hover:!text-white;
}

/* Query Loop */
.wp-block-post-template {
    @apply !gap-0;
}

.wp-block-post {
    @apply p-4 flex flex-col;
}

.wp-block-post>* {
    @apply p-0;
}

.wp-block-post-title {
    @apply mb-4 text-2xl;
}

.wp-block-post-featured-image a {
    @apply h-full;
}

.wp-block-read-more[href] {
    @apply btn-default ml-auto -mt-5 mr-2 relative z-10;
}

.wp-block-post-terms {
    @apply truncate;
}

.wp-block-post-terms a:not(:last-child) {
    @apply mr-2;
}

.wp-block-post-terms a::before {
    content: "\2022\20";
}

.wp-block-post-terms__separator {
    @apply hidden;
}

/* Query Loop always full width */
.wp-block-query {
    @apply !max-w-none;
}

/* Query Loop for Posts and Resources */
@each $type in post, pl_resource {
    .wp-block-post.type-$(type) {
        width: 100% !important;
    }

    .wp-block-post.type-$(type) img {
        height: 300px;
        object-fit: cover;
    }

    .wp-block-post.type-$(type) > .wp-block-columns {
        @apply !flex-wrap;
    }

    .wp-block-post.type-$(type) .wp-block-columns {
        @apply !m-0 !px-0;
    }

    /* Force text to go under the image */
    .wp-block-post.type-$(type) > .wp-block-columns > .wp-block-column {
        @apply !basis-full;
    }

    @screen md {
        /* On Blog/Resources page, first item is 100% width */
        .page .wp-block-post.type-$(type):first-child {
            max-width: none !important;
            width: 100% !important;
        }

        .page .wp-block-post.type-$(type):first-child .wp-block-post-title {
            @apply text-4xl;
        }

        /* First item on Blog/Resources page can have side-by-side image and text at wp-md size */
        .page .wp-block-post.type-$(type):first-child > .wp-block-columns {
            flex-wrap: nowrap !important;
        }

        .page .wp-block-post.type-$(type):first-child  > .wp-block-columns > .wp-block-column:first-child {
            flex-basis: initial !important;
            flex-shrink: 0;
            max-width: 50%;
        }

        .page .wp-block-post.type-$(type):first-child .wp-block-column:last-child {
            display: flex;
            flex-basis: initial !important;
            flex-direction: column;
        }

        .wp-block-post.type-$(type) {
            max-width: 50%;
        }

        /* Show image and text side-by-side */
        .wp-block-post.type-$(type) > .wp-block-columns {
            flex-wrap: nowrap !important;
        }

        .wp-block-post.type-$(type) > .wp-block-columns > .wp-block-column:first-child {
            max-width: 50%;
        }

        .wp-block-post.type-$(type) > .wp-block-columns > .wp-block-column:last-child {
            display: flex;
            flex-direction: column;
        }

        .wp-block-post.type-$(type) img {
            height: 324px;
        }

        .wp-block-post.type-$(type) .wp-block-post-title a {
            min-height: 0;
            @apply line-clamp-5;
        }

        .wp-block-post.type-$(type) .wp-block-post-excerpt__excerpt {
            min-height: 0;
            @apply line-clamp-5 mb-4;
        }
    }

    @screen masonry {
        .wp-block-post.type-$(type) {
            min-width: 520px;
        }

        /* First child should be 5/12 columns and not smaller than 480px */
        .wp-block-post.type-$(type):nth-child(4n+1) {
            width: 520px !important;
            min-width: 41.67% !important;
        }

        /* Second child should take the rest of the space but not bigger than 7/12 columns */
        .wp-block-post.type-$(type):nth-child(4n+2) {
            width: calc(100% - 520px) !important;
            max-width: 58.33% !important;
        }

        /* Third child should be 5/12 columns and not smaller than 480px */
        .wp-block-post.type-$(type):nth-child(4n+3) {
            width: calc(100% - 520px) !important;
            max-width: 58.33% !important;
        }

        /* Fourth child should take the rest of the space but not bigger than 7/12 columns */
        .wp-block-post.type-$(type):nth-child(4n) {
            width: 520px !important;
            min-width: 41.67% !important;
        }

        /* Min width for image and text colums */
        .wp-block-post.type-$(type) > .wp-block-columns > .wp-block-column {
            min-width: 240px;
        }

        /* On pages, the first item is 100%, so the indexing here needs to be incremented */
        .page .wp-block-post.type-$(type):nth-child(4n+2) {
            width: 520px !important;
            min-width: 41.67% !important;
        }

        .page .wp-block-post.type-$(type):nth-child(4n+3) {
            width: calc(100% - 520px) !important;
            max-width: 58.33% !important;
        }

        .page .wp-block-post.type-$(type):nth-child(4n) {
            width: calc(100% - 520px) !important;
            max-width: 58.33% !important;
        }

        .page .wp-block-post.type-$(type):nth-child(4n+1):not(:first-child) {
            width: 520px !important;
            min-width: 41.67% !important;
        }
    }
}

/**

*/

/* Post Details Block */
.post-details {
    @apply flex uppercase text-sm mt-auto;
}

.post-details > * {
    @apply truncate;
}

.post-details > *:not(:last-child) {
    @apply mr-4;
}

/* Project Details Block */
.project-details {
    @apply flex flex-col uppercase text-sm mt-auto;
}

.project-details span {
    @apply truncate;
}

/* Query Loop for Projects */
.wp-block-post.type-pl_project {
    @apply shadow-md !m-4;
    width: calc(100% - 4rem / 3) !important;
}

@screen wpmd {
    .wp-block-post.type-pl_project {
        @apply !m-0 !mr-4;
        width: calc(33.33% - 4rem / 3) !important;
    }
    .wp-block-post.type-pl_project:nth-child(3n+1) {
        @apply !m-0 !mx-4;
    }
}

.wp-block-post.type-pl_project .wp-block-post-title {
    @apply md:text-4xl;
}

.wp-block-post.type-pl_project.category-energy {
    @apply bg-orange;
}

.wp-block-post.type-pl_project.category-community {
    @apply bg-yellow;
}

.wp-block-post.type-pl_project.category-culture {
    @apply bg-light-green;
}

.wp-block-post.type-pl_project.category-economy {
    @apply bg-teal;
}

.wp-block-post.type-pl_project.category-liberation {
    @apply bg-pink;
}

.type-pl_project .wp-block-post-featured-image {
    @apply aspect-[4/3] mt-auto min-h-0 mb-4;
}

.type-pl_project .wp-block-post-featured-image img {
    @apply h-full object-cover;
}

.wp-block-post.category-energy .wp-block-read-more[href] {
    @apply bg-orange;
}

.wp-block-post.category-community .wp-block-read-more[href] {
    @apply bg-yellow;
}

.wp-block-post.category-culture .wp-block-read-more[href] {
    @apply bg-light-green;
}

.wp-block-post.category-economy .wp-block-read-more[href] {
    @apply bg-teal;
}

.wp-block-post.category-liberation .wp-block-read-more[href] {
    @apply bg-pink;
}

/* Query Loop for Members */
.wp-block-post.type-pl_member {
    @apply lg:!w-[calc(25%-1rem)]
}

.wp-block-post.type-pl_member .wp-block-post-title {
    @apply text-xl mb-2;
}

.wp-block-post.type-pl_member img {
    @apply aspect-square object-cover;
}

/* Platform Stacked Cards */
.platform-stack {
    box-sizing: border-box;
    display: block;
    padding: 100px 0;
    overflow: hidden;
    position: relative;
}

.platform-stack li {
    position: absolute;
    top: 100px;
    min-width: 400px !important;
    width: 400px !important;
}

.platform-stack li {
    @apply hover:!z-60;
}

.platform-stack li:first-child {
    position: relative;
    top: 0;
    transform: rotate(-30deg);
    @apply z-30;
}

.platform-stack li:nth-child(2) {
    left: calc(25% - 250px);
    transform: rotate(20deg);
    @apply z-40;
}

.platform-stack li:nth-child(3) {
    left: calc(50% - 250px);
    @apply z-50;
}

.platform-stack li:nth-child(4) {
    left: calc(75% - 250px);
    transform: rotate(5deg);
    @apply z-40;
}

.platform-stack li:nth-child(5) {
    right: 0;
    transform: rotate(-10deg);
    @apply z-30;
}

.platform-stack .wp-block-post-featured-image {
    @apply mb-0;
}

/* Platform Strapline */
.platform-strapline {
    @apply overflow-hidden;
}

.platform-strapline .wp-block-heading {
    @apply relative md:w-[calc(100%+5rem)] z-20;
}

.platform-illustration {
    @apply md:-mt-10 relative z-10;
    mix-blend-mode: multiply;
}

.platform-illustration__background {
    opacity: 0.2;
}

.platform-illustration svg {
    left: 4.75%;
    opacity: 0.75;
    position: absolute;
    top: 24%;
}

.platform-illustration path {
    cursor: pointer;
    transition: transform 1s;
}

.platform-illustration path:hover {
    transform: translateY(-20px);
    /*
     * z-index doesn't work for SVG elements,
     * so moving the shape to the top
     * is handled in JavaScript
     */
}

.platform-strapline hr {
    @apply mx-4 mb-4;
}

/* Banner Link (pattern) */
.banner-link .wp-block-column:last-child {
    @apply flex items-center justify-end;
}

.banner-link .wp-block-column:nth-child(2) a {
    @apply btn-default;
}

/* Our History */
.platform-history {
    @apply relative mb-8;
}

.platform-history .wp-block-navigation {
    @apply absolute -bottom-4 left-1/2 -translate-x-1/2 md:-top-4 md:left-2/3 md:bottom-auto md:translate-x-0;
}

/* Footer */
footer {
    @apply mt-16 pb-4;
}

footer hr {
    @apply mx-4 mb-8;
}

footer a {
    @apply underline;
}

footer > .wp-block-columns {
    @apply !px-4 !mb-8;
}

footer .wp-block-columns {
    @apply mb-0 px-0 md:py-0;
}

footer .wp-block-column:last-child h2 {
    @apply truncate;
}

footer .wp-block-navigation__container {
    @apply min-w-0 flex-col md:flex-row;
}

footer .wp-block-navigation {
    @apply mt-4;
}

footer .wp-block-navigation-item {
    @apply min-w-0 w-full md:w-auto;
}

footer .wp-block-navigation-item a {
    @apply w-full text-center md:w-auto;
}

.footer-links h6 {
    @apply mb-1;
}

.footer-links a {
    @apply block mb-2;
}

/* Gravity Forms */
.gform_wrapper > form {
    @apply flex flex-col md:flex-row gap-4 mt-4;
}

.gform_body {
    @apply grow md:max-w-input;
}

.gform_fields input {
    @apply border border-dark-green rounded-full shadow-md;
}

.gform_footer {
    @apply !m-0 !p-0;
}

.gform_button {
    @apply btn-default w-full md:w-auto;
}

/* Category Cards */
.platform-category-cards {
    @apply p-0 !max-w-1024 mt-0 mb-12 !flex-wrap justify-center;
}

.platform-category-cards .wp-block-column {
    @apply p-4 md:min-w-320 md:h-320 md:max-w-320 rounded shadow-md;
}

/* Tabs */
nav.platform-tabs {
    @apply border-b border-dark-green mb-16;
}

.platform-tabs ul {
    @apply flex flex-wrap pl-2;
}

.platform-tabs li {
    @apply mb-2 md:mb-0;
}

.platform-tabs li:not(:last-child) {
    @apply mr-2;
}

.platform-tabs button {
    @apply rounded-lg md:rounded-bl-none md:rounded-br-none hover:!bg-dark-green hover:!text-white !py-2 !px-4;
}

.platform-tabs button.active {
    @apply bg-dark-green text-white;
}

.platform-about-final-buttons {
    @apply px-4 mb-16 flex;
}

/* Post Filter on Blog/Resources Page */
.post-filter {
    @apply px-4 mb-8;
}

.post-filter__categories {
    @apply flex flex-wrap mb-4;
}

.post-filter__categories li:not(:last-child) {
    @apply mr-2;
}

.post-filter__categories .energy {
    @apply bg-orange !border-0;;
}

.post-filter__categories .community {
    @apply bg-yellow !border-0;;
}

.post-filter__categories .culture {
    @apply bg-light-green !border-0;;
}

.post-filter__categories .economy {
    @apply bg-teal !border-0;;
}

.post-filter__categories .liberation {
    @apply bg-pink !border-0;;
}

.post-filter__categories .active {
    @apply !bg-dark-green !text-white;
}

/*
 * Projects Carousel
 */

.projects-carousel {
    @apply relative;
}

@screen sm {
    .projects-carousel {
        --card-width: 320px;
    }
}

@screen md {
    .projects-carousel {
        --card-width: 400px;
    }
}

@screen lg {
    .projects-carousel {
        --card-width: 560px;
    }
}

.projects-carousel .wp-block-cover {
    @apply !px-0 !pb-4;
    background-color: #fff39d;
    margin-top: -250px;
    padding-top: calc(250px + 1rem);
}

.projects-carousel .wp-block-navigation__container {
    @apply mb-16 justify-center hidden md:flex;
}

.projects-carousel .wp-block-navigation__container li {
    transform: translateY(-3rem) rotate(-10deg);
    margin-left: 28rem;
}

.projects-carousel .wp-block-query {
    overflow: hidden;
}

.projects-carousel__button {
    background-color: white;
    position: absolute;
    top: 50%;
    z-index: 1;
    @apply btn-default-no-padding !rounded-full !px-[0.9rem] !py-2 md:hidden;
}

.projects-carousel__button:first-child {
    left: 0.5rem;
}

.projects-carousel__button:last-child {
    right: 0.5rem;
}

.projects-carousel .wp-block-post-template {
    flex-wrap: nowrap;
    margin-left: 50%;
    max-width: none;
    /* 
     * Start by displaying the second post. Transform left (negative) by the
     * width of 1.5 cards.
     */
    transform: translate3d(calc(var(--card-width) * -1.5), 0, 0);
    transition: transform 1.5s;
}

.projects-carousel .wp-block-post {
    cursor: pointer;
    margin: 0 !important;
    max-width: var(--card-width) !important;
    min-width: var(--card-width) !important;
    transform: scale(1);
    width: var(--card-width) !important;
    transition: transform 1.5s;
}

.projects-carousel .wp-block-post-featured-image {
    @apply !mb-0;
}

.projects-carousel .wp-block-post:not(:nth-child(2)) {
    transform: scale(0.8);
}

/* Search Page */
body.search h1.wp-block-heading {
    @apply text-4xl md:text-6xl mb-4;
}

body.search .wp-block-search {
    @apply mx-auto mb-8;
    max-width: 680px;
}

body.search.search-results .wp-block-post {
    @apply !p-0 !m-0;
    background: none !important;
    box-shadow: none !important;
    max-width: none !important;
    width: auto !important;
}

body.search.search-results .wp-block-post .wp-block-group {
    @apply !mb-2;
}

body.search.search-results .wp-block-post .wp-block-post-title {
    @apply !mb-2;
}

body.search.search-results .wp-block-post .wp-block-post-featured-image {
    @apply !my-auto;
    height: 100% !important;
    max-height: 200px;
}

body.search.search-results .wp-block-post img {
    aspect-ratio: auto !important;
    height: 100% !important;
    max-height: 200px;
}

body.search.search-results .wp-block-post .wp-block-columns {
    @apply !p-0 !mb-2;
}

body.search.search-results .wp-block-post > .wp-block-columns {
    @apply !my-4;
}

body.search.search-results .wp-block-post > .wp-block-columns > .wp-block-column {
    flex-basis: 66.66% !important;
    max-width: none;
}

body.search.search-results .wp-block-post > .wp-block-columns > .wp-block-column:last-child {
    flex-basis: 33.33% !important;
}
